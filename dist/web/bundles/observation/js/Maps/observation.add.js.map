{"version":3,"sources":["../../../../../../web/bundles/observation/js/Maps/observation.add.js"],"names":["initMap","myLatlng","lat","lng","map","google","maps","Map","document","getElementById","center","zoom","marqueur","Marker","geocoder","Geocoder","infowindow","InfoWindow","iconBaseOiseaux","lat_lng","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","setCenter","handleLocationError","infoWindow","getCenter","event","addListener","latLng","geocode","results","status","setMap","setIcon","setPosition","LatLng","value","locationField","address_components","long_name","textContent","setContent","open","window","alert","addEventListener","setZoom","marker","browserHasGeolocation","pos","$","modal","on"],"mappings":"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","file":"observation.add.js","sourcesContent":["//Initialisation de la map\nfunction initMap()\n{\n\n    var myLatlng = {lat: 48.866667, lng: 2.333333};\n    map = new google.maps.Map(document.getElementById('map'),\n        {\n            center: myLatlng,\n            zoom: 12\n        }),\n        marqueur = new google.maps.Marker(),\n        geocoder = new google.maps.Geocoder,\n        infowindow = new google.maps.InfoWindow,\n        iconBaseOiseaux = 'http://localhost/NAO/web/bundles/observation/images/icones/crow_red.png';\n    var lat_lng;\n\n\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            myLatlng = {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            };\n\n            map.setCenter(myLatlng);\n        }, function () {\n            handleLocationError(true, infoWindow, map.getCenter());\n        });\n    } else {\n        // Browser doesn't support Geolocation\n        handleLocationError(false, infoWindow, map.getCenter());\n    }\n\n\n    //Création d'un marqueur sur la carte lors d'un clic. Remplissage automatique des champs Lat et Long\n    google.maps.event.addListener(map, 'click', function (event)\n    {\n        lat_lng = {lat: event.latLng.lat(), lng: event.latLng.lng()};\n\n        geocoder.geocode({'location': lat_lng}, function(results, status){\n            if (status === 'OK')\n            {\n                if (results[0])\n                {\n                    marqueur.setMap(map);\n                    marqueur.setIcon(iconBaseOiseaux);\n                    marqueur.setPosition(new google.maps.LatLng(event.latLng.lat(), event.latLng.lng()));\n                    map.setCenter(lat_lng);\n\n                    document.getElementById(\"add_observation_location_latitude\").value = event.latLng.lat();\n                    document.getElementById(\"add_observation_location_longitude\").value = event.latLng.lng();\n\n                    var locationField = document.getElementById(\"add_observation_location_lieu\");\n                    locationField.value = results[0].address_components[2].long_name;\n\n                    document.getElementById(\"infoPosition\").textContent = locationField.value;\n                    infowindow.setContent(results[0].address_components[2].long_name);\n                    infowindow.open(map, marqueur);\n                }\n                else\n                {\n                    window.alert('Aucun résultat');\n                }\n            }\n            else\n            {\n                window.alert('Géolocalisation échec: ' + status);\n            }\n        })\n    });\n\n\n//Geolocalisation du user\n\n    document.getElementById(\"autoGeo\").addEventListener(\"click\", function () {\n\n        // Géolocalisation du user.\n        if (navigator.geolocation)\n        {\n            navigator.geolocation.getCurrentPosition(function(position)\n                {\n                    lat_lng = {lat: position.coords.latitude, lng: position.coords.longitude};\n\n                    geocoder.geocode({'location': lat_lng}, function(results, status){\n                        if (status === 'OK')\n                        {\n                            if (results[0])\n                            {\n\n                                marqueur.setMap(map);\n                                marqueur.setPosition(lat_lng);\n                                marqueur.setIcon(iconBaseOiseaux);\n                                map.setCenter(lat_lng);\n                                map.setZoom(14);\n\n                                document.getElementById(\"add_observation_location_latitude\").value = lat_lng.lat;\n                                document.getElementById(\"add_observation_location_longitude\").value = lat_lng.lng;\n                                document.getElementById(\"add_observation_location_lieu\").value = results[0].address_components[2].long_name;\n\n                                infowindow.setContent(results[0].address_components[2].long_name);\n                                infowindow.open(map, marqueur);\n                            }\n                            else\n                            {\n                                window.alert('Aucun résultat');\n                            }\n                        }\n                        else\n                        {\n                            window.alert('Géolocalisation échec: ' + status);\n                        }\n                    })\n                },\n                //gestion des erreurs de geolocalisation\n                function() {\n                    handleLocationError(true, marker, map.getCenter());\n                });\n        }\n        else\n        {\n            // Browser doesn't support Geolocation\n            handleLocationError(false, marker, map.getCenter());\n        }\n\n        //Gestion des erreurs de géolocalisation\n        function handleLocationError(browserHasGeolocation, infoWindow, pos)\n        {\n            infoWindow.setPosition(pos);\n            infoWindow.setContent(browserHasGeolocation ?\n                'Error: The Geolocation service failed.' :\n                'Error: Your browser doesn\\'t support geolocation.');\n        }\n    })\n\n}\n\ndocument.getElementById(\"locationChoice\").addEventListener('click', function () {\n    $('#myModal').modal('show').on('shown.bs.modal', function () {\n        initMap();\n    });\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}