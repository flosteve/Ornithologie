{% extends 'ObservationBundle::layout.desktop.html.twig' %}
{% block title %}Observation{% endblock %}

{% form_theme form 'ObservationBundle:Form:locationField.html.twig' %}


{% block content %}
    <div id="contentAdd">
    <div id="flash">{% for flash_message in app.session.flashBag.get('notice') %}
            <div class="alert alert-success">
                <strong>{{ flash_message }}</strong>
            </div>
        {% endfor %}
    </div>
        <div id="formObs" class="panel panel-default center-80">
            {% if app.session.get('getBird') == true %}
                <h1>{{ bird.LbNom }}</h1>
            {% else %}
                <h1>Saisir une observation</h1>
            {% endif %}

            <div class="panel-body">
                {{ form_start(form, {'attr': {'class': 'form-horizontal', 'enctype': 'multipart/form-data'}}) }}
                {{ form_errors(form) }}

            {#Localisation Observation#}
                <div class="form-group col-xs-8">
                    <div>
                        {{ form_label(form.location) }}
                        {{ form_errors(form.location) }}
                        {{ form_widget(form.location, {'attr':{'class': 'col-xs-10 col-xs-offset-1'}}) }}
                        <button type="button" class="btn btn-nao col-xs-10 col-xs-offset-1" id="locationChoice">
                            Selectioner votre position
                        </button>
                    </div>
                </div>
            {#Modale de la map#}
                <div class="modal fade" id="myModal">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Lieu de l'observation</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true" class="glyphicon glyphicon-remove"></span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div id="map"></div>
                            </div>
                            <div class="modal-footer">
                                <span id="infoPosition"></span>
                                <button type="button" class="btn btn-nao col-xs-offset-1" id="currentPosition"
                                        data-dismiss="modal">Valider la position
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            {#Date de l'observation#}
                <div class="form-group col-xs-8">
                    <div class="row">
                        <div class="col-xs-10 col-xs-offset-1 col-xs-offset-1">
                            {{ form_label(form.seeAt, form.vars.label) }}
                            {{ form_errors(form.seeAt) }}
                            {{ form_widget(form.seeAt, { 'id': 'datepicker'}) }}
                        </div>
                    </div>
                </div>

                {% if app.session.get('getBird') == false %}
                    <div class="form-group col-xs-8">
                    <div class="row">
                        <div class="col-xs-10 col-xs-offset-1">
                            {{ form_label(form.bird, form.vars.label) }}
                            {{ form_errors(form.bird) }}
                            {{ form_widget(form.bird) }}
                        </div>
                    </div>
                </div>
                {% endif %}
                {% if app.session.get('getBird') == true %}
                    <div style="display: none" id="getBird">
                        {{ form_label(form.bird, form.vars.label) }}
                        {{ form_errors(form.bird) }}
                        {{ form_widget(form.bird) }}
                    </div>
                {% endif %}

                <div class="form-group col-xs-8">
                    <div class="row">
                        <div class="col-xs-10 col-xs-offset-1">
                            {{ form_label(form.quantity, form.vars.label) }}
                            {{ form_errors(form.quantity) }}
                            {{ form_widget(form.quantity, {'type': 'number'}) }}
                        </div>
                    </div>
                </div>
                <div class="form-group col-xs-8">
                    <div class="row">
                        <div class="col-xs-10 col-xs-offset-1">
                            {{ form_label(form.files) }}
                            {{ form_errors(form.files) }}
                            {{ form_widget(form.files) }}<br>

                            <div id="picBird" class="col-xs-12">
                                <button type="button" class="close" aria-label="Close" id="closePic" hidden>
                                    <span aria-hidden="true" class="glyphicon glyphicon-remove"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group col-xs-8">
                    <div class="row">
                        <div class="col-xs-10 col-xs-offset-1">
                            {{ form_label(form.observation) }}
                            {{ form_errors(form.observation) }}
                            {{ form_widget(form.observation) }}
                        </div>
                </div>
                    <p class="col-xs-offset-1">* Champs Obligatoires</p>
                </div>


                <div class="text-center col-xs-8">
                    {{ form_widget(form.save, {'attr':{'class': 'btn-nao'}}) }}
                </div>

                {{ form_end(form) }}

            </div>
        </div>
    </div>

{% endblock %}

{% block javascript %}
    {{ parent() }}
        <script src="{{ asset('bundles/observation/js/Maps/observation.add.js') }}"></script>
        <script src="{{ asset('bundles/observation/js/observation.js') }}"></script>
            <script async defer
                    src="https://maps.googleapis.com/maps/api/js?v=3&amp;key={{ google_api_key }}&callback=initMap">
            </script>
{% endblock %}











